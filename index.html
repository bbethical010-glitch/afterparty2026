<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Encore After Party ‚Äì Entry System</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Rajdhani', sans-serif;
  background: url("https://www.thegrandarc.com/images/grand-banner.jpg") center/cover no-repeat fixed;
}
.overlay {
  background: rgba(0,0,0,0.85);
  min-height: 100vh;
}
h1,h2,h3 { font-family: 'Orbitron', sans-serif; }
</style>
</head>

<body>
<div id="passwordGate" class="overlay flex items-center justify-center">
  <div class="bg-black p-6 rounded-xl border border-gray-700 text-center w-80">
    <h2 class="text-white mb-4">Organizer Access</h2>
    <input id="pw" type="password" placeholder="Enter password"
      class="w-full p-3 rounded bg-gray-900 text-white mb-4">
    <button onclick="unlock()" class="w-full bg-green-500 text-black font-bold py-2 rounded">
      Unlock
    </button>
  </div>
</div>

<div id="app" class="overlay hidden flex flex-col items-center p-6">

<h1 class="text-white text-3xl mb-6">Encore Entry Verification</h1>

<div class="bg-black p-6 rounded-xl w-full max-w-sm border border-gray-700">
  <p class="text-gray-400 mb-3 text-sm">Organizer use only ¬∑ Payment required</p>

  <input id="entryId" placeholder="JAI-0XX"
    class="w-full p-3 text-center text-lg uppercase rounded bg-gray-900 text-white mb-4">

  <button id="verifyBtn"
    class="w-full bg-pink-500 text-black font-bold py-3 rounded">
    VERIFY ENTRY
  </button>

  <div id="result" class="mt-4 text-xl font-bold text-center"></div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
  getFirestore, doc, getDoc, updateDoc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* üî¥ REPLACE WITH YOUR CONFIG */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const btn = document.getElementById("verifyBtn");
const result = document.getElementById("result");

btn.onclick = async () => {
  const id = document.getElementById("entryId").value.trim().toUpperCase();
  if (!id) return;

  btn.disabled = true;
  result.textContent = "Checking‚Ä¶";
  result.className = "text-yellow-400";

  try {
    const ref = doc(db, "guest_list", id);
    const snap = await getDoc(ref);

    if (!snap.exists()) {
      result.textContent = "‚ùå ID NOT FOUND";
      result.className = "text-red-500";
    } else {
      const data = snap.data();

      if (data.checkedIn) {
        result.textContent = "üö´ ALREADY USED";
        result.className = "text-red-500";
      } else if (!data.paid) {
        result.textContent = "üí∞ PAYMENT PENDING";
        result.className = "text-orange-400";
      } else {
        await updateDoc(ref, {
          checkedIn: true,
          checkedInAt: serverTimestamp()
        });
        result.textContent = "‚úÖ ENTRY APPROVED";
        result.className = "text-green-400 text-2xl";
      }
    }
  } catch (e) {
    result.textContent = "‚ö†Ô∏è SYSTEM ERROR";
    result.className = "text-red-400";
  }

  btn.disabled = false;
  document.getElementById("entryId").value = "";
};
</script>

<script>
const PASSWORD = "encore2026"; // change this

function unlock() {
  if (document.getElementById("pw").value === PASSWORD) {
    document.getElementById("passwordGate").classList.add("hidden");
    document.getElementById("app").classList.remove("hidden");
  } else {
    alert("Wrong password");
  }
}
</script>

</body>
</html>
